var IT = IT || {}, base_url = base_url || "", base_events = [ "blur", "change", "click", "dblclick", "focus", "hover", "keydown", "keypress", "keyup", "show", "hide" ], transitionEnd = "webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend", animationEnd = "webkitAnimationEnd oanimationend msAnimationEnd animationend";

IT.BaseClass = class {
    get isClass() {
        return !0;
    }
}, IT.Component = class extends IT.BaseClass {
    constructor(t) {
        super(t);
        let e = this;
        e._id = "", e.settings = t || {}, e.content = null;
    }
    renderTo(t) {
        this.content.appendTo && this.content.appendTo(t);
    }
    get id() {
        return this._id;
    }
    set id(t) {
        this._id = t;
    }
    getId() {
        return this.id;
    }
    getContent() {
        return this.content;
    }
    getSetting() {
        return this.settings;
    }
}, IT.Button = class extends IT.Component {
    constructor(t) {
        super(t);
        let e = this;
        e.settings = $.extend(!0, {
            id: "",
            buttonClass: "",
            iconClass: "",
            enable: !0,
            enableDropdown: !0,
            text: "Tombol",
            items: [],
            css: {}
        }, t), e.id = e.settings.id || IT.Utils.id(), e.enable = e.settings.enable, e.listener = new Listener(e, e.settings, [ "onClick" ]);
        let s = $("<a/>", {
            id: e.id,
            html: e.settings.text,
            class: "it-btn " + e.settings.buttonClass,
            css: e.settings.css
        });
        if (s.click(function(t) {
            e.enable && ("function" == typeof e.settings.handler && e.settings.handler.call(), 
            e.listener.fire("onClick", [ e, e.id ]), t.stopPropagation());
        }), e.settings.iconClass) {
            let t = $("<span/>", {
                class: "fa fa-" + e.settings.iconClass,
                html: "&nbsp;"
            });
            s.prepend(t);
        }
        if (e.content = s, e.settings.enable || e.setEnable(!1), e.settings.items.length) {
            let t = $("<div/>", {
                class: "it-btn-group"
            });
            t.append(e.content);
            let s = new IT.Button({
                iconClass: "angle-down",
                buttonClass: e.settings.buttonClass + " btn-dropdown ",
                text: "",
                handler: function() {
                    e.content.find(".menu-group").toggle(), n.removeClass("menu-reverse"), n.offset().top + n.outerHeight() > $(window).height() && n.addClass("menu-reverse");
                }
            });
            s.setEnable(e.settings.enableDropdown), s.renderTo(t);
            let n = $("<ul/>", {
                class: "menu-group"
            });
            $.each(e.settings.items, function(t, e) {
                if (e) {
                    let t = $("<li/>", {
                        class: "clearfix"
                    });
                    "string" == typeof e ? e = IT.Utils.createObject({
                        xtype: "html",
                        content: $("<div/>", {
                            class: "menu-group-separator"
                        })
                    }) : e.isClass || (e = $.extend(!0, {
                        xtype: "button"
                    }, e), e = IT.Utils.createObject(e)), e.renderTo(t), t.appendTo(n);
                }
            }), t.append(n), e.content = t;
        }
    }
    renderTo(t) {
        super.renderTo(t), this.settings.items.length && $(document).click(function(t) {
            $(t.target).closest(".menu-group").length || $(".menu-group").hide();
        });
    }
    setEnable(t) {
        this.enable = t, this.content[this.enable ? "removeClass" : "addClass"]("btn-disabled");
    }
}, IT.DataTable = class extends IT.Component {
    constructor(t) {
        super(t);
        let e = this;
        e.settings = $.extend(!0, {
            id: "",
            cls: "it-grid",
            width: "100%",
            height: "auto",
            top: 0,
            bottom: 0,
            cellEditing: !0,
            sort: "local",
            wrap: !1,
            paging: !0,
            store: {
                type: "json",
                params: {
                    start: 0,
                    limit: 20,
                    orderBy: "",
                    sortBy: ""
                }
            },
            columns: [ {} ]
        }, t), e.id = e.settings.id || IT.Utils.id(), e.listener = new IT.Listener(e, e.settings, [ "onItemClick", "onItemDblClick", "onLoad", "onChangePage" ]), 
        e.settings.store.isClass || (e.store = new IT.Store($.extend(!0, {
            onLoad: function(t, s, n) {
                e.assignData(s), e.listener.fire("onLoad", [ e, t ]);
            }
        }, e.settings.store))), e.page = 1, e.pageCount = 1, e.params = e.store.params, 
        e.selectedRecord = null, e.selectedColumn = null, e.createComponent(), e.store.getData();
    }
    createComponent() {
        let t = this;
        t.content = $("<div />", {
            id: t.id,
            class: t.settings.cls
        }).width(t.settings.width).height(t.settings.height);
        let e, s = $("<thead>");
        for (let n = 0; n < t.settings.columns.length; n++) e = t.settings.columns[n], s.append(`<th></th>`);
        t.content.append(s);
    }
    assignData(t) {
        let e = this;
        t && t.rows && e.content.find("tbody").empty();
    }
}, IT.Dialog = class extends IT.Component {
    constructor(t) {
        super(t);
        let e = this;
        e.elExist = !1, e.settings = $.extend(!0, {
            id: "",
            title: "",
            iconCls: "",
            items: [],
            overlay: !0,
            autoShow: !0,
            width: 300,
            height: 100,
            autoHeight: !0,
            css: {}
        }, t), e.id = e.settings.id || IT.Utils.id(), e.listener = new IT.Listener(e, e.settings, [ "onShow", "onHide", "onClose" ]), 
        e.createElement(), e.settings.autoShow && e.show();
    }
    createElement() {
        let t = this;
        if (t.content = $(`\n\t\t\t<div class="it-dialog">\n\t\t\t\t<div class="it-dialog-container">\n\t\t\t\t\t<div class="it-dialog-content"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`), 
        t.settings.title) {
            let e = $("<div/>", {
                class: "it-title",
                html: t.settings.title
            });
            if (t.settings.iconCls) {
                let s = $("<span/>", {
                    class: "fa fa-" + t.settings.iconCls
                });
                s.prependTo(e);
            }
            t.content.find(".it-dialog-container").prepend(e);
        }
        t.settings.overlay || t.content.addClass("no-overlay"), $.each(t.settings.items, function(e, s) {
            s && (s.isClass || (s = IT.Utils.createObject(s)), s ? s.renderTo(t.content.find(".it-dialog-content")) : console.warn("Xtype: undefined", obj));
        }), t.content.find(".it-dialog-container").css({
            "max-width": t.settings.width
        }), t.content.find(".it-dialog-content").css($.extend(!0, t.settings.css, t.settings.autoHeight ? {
            "min-height": t.settings.height
        } : {
            height: t.settings.height
        })), t.content.appendTo("body").hide(), t.elExist = !0, t.settings.autoShow && t.show();
    }
    show() {
        let t = this;
        t.elExist || t.createElement(), t.content.show(0, function() {
            $(this).addClass("dialog-show"), $(this).find(".it-dialog-container").addClass("dialog-show");
        }), t.listener.fire("onShow", [ t, t.id ]), $(window).resize(function() {
            t._autoScrollContainer();
        }), t._autoScrollContainer();
    }
    hide() {
        let t = this;
        t.content.find(".it-dialog-container").removeClass("dialog-show").one(transitionEnd, function() {
            t.content.removeClass("dialog-show"), t.listener.fire("onHide", [ t, t.id ]);
        });
    }
    close() {
        let t = this;
        t.content.find(".it-dialog-container").removeClass("dialog-show").one(transitionEnd, function() {
            t.content.removeClass("dialog-show").one(transitionEnd, function() {
                setTimeout(() => {
                    t.elExist = !1, t.content.remove(), t.listener.fire("onClose", [ t, t.id ]);
                }, 300);
            });
        });
    }
    _autoScrollContainer() {
        let t = this.content.find(".it-dialog-container"), e = $(window).height();
        e - (t.offset().top + t.outerHeight()) <= 20 ? t.css({
            "overflow-y": "scroll",
            height: e - 30
        }) : t.css({
            "overflow-y": "initial",
            height: "auto"
        });
    }
}, IT.Form = class extends IT.Component {
    constructor(t) {
        super(t);
        let e = this;
        e.settings = $.extend(!0, {
            id: "",
            items: []
        }, t), e.id = e.settings.id || IT.Utils.id();
        let s, n = $("<div />", {
            id: e.id,
            class: "container-fluid"
        }), i = 0;
        $.each(e.settings.items, function(t, e) {
            e && (s = $("<div>", {
                class: "row"
            }), e.isClass || (e = IT.Utils.createObject(e)), e.renderTo(s), n.append(s), i++);
        }), e.content = $("<form />", {
            name: IT.Utils.id(),
            class: "it-form"
        }), e.content.append(n);
    }
}, IT.FormItem = class extends IT.Component {
    constructor(t) {
        super(t);
    }
    val(t) {
        return void 0 === t ? this.input.val() : this.input.val(t);
    }
    setInvalid(t = !0) {
        this.input[t ? "addClass" : "removeClass"]("invalid");
    }
    validate() {
        return !(!this.settings.allowBlank && "" == this.val());
    }
    setReadonly(t = !1) {
        this.input.attr("readonly", t)[t ? "addClass" : "removeClass"]("input-readonly");
    }
    setEnabled(t = !1) {
        this.input.attr("disabled", !t)[t ? "removeClass" : "addClass"]("input-disabled");
    }
}, IT.Grid = class extends IT.Component {
    constructor(t) {
        super(t);
        let e = this;
        if (e.settings = $.extend(!0, {
            id: "",
            type: "row",
            columnRule: "",
            rowContainer: "",
            css: {},
            items: []
        }, t), e.id = e.settings.id || IT.Utils.id(), "row" == e.settings.type) e.content = $("<div/>", {
            id: e.id,
            class: "row"
        }); else {
            if ("column" != e.settings.type) return console.info("Grid hanya mempunyai 2 type : row atau column"), 
            void (e.content = "");
            e.content = $("<div />", {
                id: e.id,
                class: e.settings.columnRule
            });
        }
        e.content.css(e.settings.css), $.each(e.settings.items, function(t, s) {
            s && ("function" != typeof s.renderTo && (s = IT.Utils.createObject(s)), s.renderTo(e.content));
        }), "row" == e.settings.type && "fluid" == e.settings.rowContainer ? e.content = $("<div/>", {
            class: "container-fluid"
        }).append(e.content) : "row" == e.settings.type && "standar" == e.settings.rowContainer && (e.content = $("<div/>", {
            class: "container"
        }).append(e.content));
    }
}, IT.HTML = class extends IT.Component {
    constructor(t) {
        super(t);
        let e = this;
        e.settings = $.extend(!0, {
            id: "",
            url: "",
            content: "",
            css: {},
            class: ""
        }, t), e.id = e.settings.id || IT.Utils.id(), e.content = $("<div/>", {
            id: e.id
        }), e.settings.class && e.content.addClass(e.settings.class), e.content.css(e.settings.css), 
        e.settings.url ? e.content.load(e.settings.url) : e.content.html(e.settings.content);
    }
    setContent(t, e = !1) {
        e && this.content.empty(), "string" == typeof t ? this.content.append(t) : t.appendTo(this.content);
    }
}, IT.Listener = class extends IT.BaseClass {
    constructor(t, e, s = []) {
        super();
        let n = this;
        n.events = {}, n.scope = t, s.forEach(t => n.events[t] = e[t]);
    }
    fire(t, e) {
        var s = this;
        if ("function" == typeof s.events[t]) return s.events[t].apply(s.scope, e);
    }
}, IT.Select = class extends IT.Component {
    constructor(t) {
        super(t);
        let e = this;
        e.settings = $.extend(!0, {
            id: "",
            value: "Button",
            emptyText: "",
            format: null,
            defaultValue: "",
            autoLoad: !0,
            allowBlank: !0,
            disabled: !1,
            width: 200,
            datasource: {
                type: "array",
                url: "",
                data: null
            },
            selectize: {
                allowEmptyOption: !0
            }
        }, t), e.id = e.settings.id || makeid(), e.select = $("<select />", {
            id: e.id,
            name: e.id,
            attr: {
                disabled: e.settings.disabled
            },
            val: e.settings.defaultValue
        }), e.content = $("<div />", {
            class: "it-edit"
        }), e.content.append(e.select), e.select.selectize($.extend(!0, e.settings.selectize)), 
        e.settings.width && e.content.css({
            width: e.settings.width
        }), e.settings.emptyText && e.getSelect().addOption({
            value: "",
            text: e.settings.emptyText
        }), e.settings.autoLoad && e.getDataSource();
    }
    val(t) {
        void 0 === t ? this.getSelect().setValue(t) : this.getSelect().getValue();
    }
    setDataSouce(t) {
        this.settings.datasource = t, this.dataSource();
    }
    getDataSource() {
        let t = this, e = t.settings.datasource, s = t.getSelect();
        switch (s.clear(), e.type) {
          case "array":
            void 0 !== e.data && e.data.length > 0 && $.each(e.data, function(t, e) {
                s.addOption({
                    value: e.key,
                    text: e.value,
                    params: void 0 !== e.params ? JSON.stringify(e.params) : ""
                });
            }), s.setValue(t.settings.defaultValue);
            break;

          case "ajax":
            $.ajax({
                url: e.url,
                type: e.method || "POST",
                data: e.params || {},
                dataType: "json",
                success: function(e) {
                    var n = e.rows;
                    void 0 !== n && n.length > 0 && $.each(n, function(t, e) {
                        s.addOption({
                            value: e.key,
                            text: e.value,
                            params: void 0 !== e.params ? JSON.stringify(e.params) : ""
                        });
                    }), s.setValue(t.settings.defaultValue);
                }
            });
        }
    }
    getSelect() {
        return this.select[0].selectize;
    }
}, IT.Store = class extends IT.BaseClass {
    constructor(t) {
        super(t);
        let e = this;
        e.settings = $.extend({
            type: "json",
            url: "",
            autoLoad: !1,
            params: {
                start: 0,
                limit: 20
            }
        }, t), e.params = e.settings.params, e.dataChanged = [], e.storeData = {
            rows: [],
            total_rows: 0
        }, e.listener = new IT.Listener(e, e.settings, [ "beforeLoad", "onLoad", "onError" ]), 
        e.settings.autoLoad && e.load();
    }
    empty() {
        me.dataChanged = [], me.storeData = {
            rows: [],
            total_rows: 0
        };
    }
    load(t) {
        let e = this;
        var t = t || {};
        switch (e.settings.type) {
          case "json":
            var s = $.extend(e.settings.params, t.params);
            e.params = s, e.dataChanged = [], $.ajax({
                dataType: e.settings.type,
                type: "POST",
                url: e.settings.url,
                data: s,
                beforeSend: function(t, s) {
                    return e.listener.fire("beforeLoad", [ e, t, s ]);
                },
                success: function(t) {
                    void 0 !== t.rows && void 0 !== t.total_rows ? (e.storeData = t, e.listener.fire("onLoad", [ e, e.storeData, e.params ])) : (e.storeData = {}, 
                    e.listener.fire("onError", [ e, {
                        status: !1,
                        message: "Format Data Tidak Sesuai"
                    } ]));
                },
                error: function() {
                    e.listener.fire("onError", [ e, {
                        status: !1,
                        message: "Data JSON '" + e.settings.url + "' Tidak Ditemukan"
                    } ]);
                },
                complete: function() {
                    e.listener.fire("afterLoad", [ e, e.storeData ]);
                }
            });
            break;

          case "array":
            e.listener.fire("beforeLoad", [ e, a, b ]), void 0 !== e.settings.data.rows && void 0 !== e.settings.data.total_rows ? (e.storeData = e.settings.data, 
            e.listener.fire("onLoad", [ e, e.storeData, e.params ])) : e.listener.fire("onError", [ e, {
                status: !1,
                message: "Data JSON '" + e.settings.url + "' Tidak Ditemukan"
            } ]), e.listener.fire("afterLoad", [ e, e.storeData ]);
        }
    }
    searchData(t, e) {
        if (index = null, me.storeData.rows && me.storeData.rows.length > 0) for (i = 0; i < me.storeData.rows.length; i++) if (me.storeData.rows[i][t] == e) {
            index = i;
            break;
        }
        return index;
    }
    sort(t, e = !0) {
        throw "Deprecated, doesn't support ordering in front side";
    }
    getParams() {
        return this.params;
    }
    getData() {
        return this.storeData;
    }
    setData(t) {
        this.storeData = t;
    }
    getSetting() {
        return this.settings;
    }
}, IT.Tabs = class extends IT.Component {
    constructor(t) {
        super(t);
        let e = this;
        e.settings = $.extend(!0, {
            id: "",
            titles: {
                align: "left",
                items: []
            },
            items: [],
            defaultIndexActive: 0,
            height: 100,
            autoHeight: !1
        }, t), e.id = e.settings.id || IT.Utils.id(), e.ids = [], e.content = $(`\n\t\t\t<div id="${e.id}" class="it-tabs">\n\t\t\t\t<ul class="it-tabs-menu ${e.settings.titles.align}"></ul>\n\t\t\t\t<div class="it-tabs-overflow">\n\t\t\t\t\t<span class="btn-overflow"><i class="fa fa-angle-down"></i></span>\n\t\t\t\t\t<ul class="menu-overflow"></ul>\n\t\t\t\t</div>\n\t\t\t\t<div class="it-tabs-container"></div>\n\t\t\t</div>`), 
        e.content.css(e.settings.autoHeight ? "min-height" : "height", e.settings.height), 
        $.each(e.settings.titles.items, function(t, s) {
            let n = IT.Utils.id(), i = $("<li/>", {
                class: "it-tabs-link",
                html: s,
                attr: {
                    "data-tab": n,
                    "data-index": t
                }
            });
            i.appendTo(e.content.find(".it-tabs-menu")), i.click(function() {
                e.setActive($(this).data("index"));
            }), e.ids.push(n);
        }), $.each(e.settings.items, function(t, s) {
            if (s) {
                let n = $("<div/>", {
                    class: "it-tabs-content",
                    id: e.ids[t]
                });
                s.isClass || (s = IT.Utils.createObject(s)), s.renderTo(n), n.appendTo(e.content.find(".it-tabs-container"));
            }
        }), e.content.find(".btn-overflow").click(function() {
            $(this).next().toggle();
        });
    }
    renderTo(t) {
        super.renderTo(t);
        let e = this;
        $(window).resize(function() {
            e._autoShowMore();
        }), e._autoShowMore(), e.setActive(e.settings.defaultIndexActive), setTimeout(() => {
            e._autoShowMore();
        }, 10);
    }
    setActive(t) {
        let e, s = this, n = s.content.find(".it-tabs-menu li").eq(t);
        if (n.length < 1) throw "offset index";
        s.content.find(".tab-active").removeClass("tab-active"), e = n.addClass("tab-active"), 
        s.content.find("#" + e.data("tab")).addClass("tab-active");
    }
    getActive() {
        let t = this.getContent().find(".it-tabs-menu li.tab-active");
        return {
            index: t.index(),
            content: t
        };
    }
    _autoShowMore() {
        let t = this, e = t.content.find(".menu-overflow");
        e.empty();
        let s = t.content.find(".it-tabs-menu li");
        s.show(), s.each(function() {
            $(this).position().left + $(this).outerWidth() > t.content.width() && ($(this).clone(!0).appendTo(e), 
            $(this).hide());
        }), t.content.find(".it-tabs-overflow").toggle(e.children("li").length > 0);
    }
}, IT.TextBox = class extends IT.FormItem {
    constructor(t) {
        super(t);
        let e, s = this;
        switch (s.settings = $.extend(!0, {
            x: "textbox",
            type: "text",
            cols: 19,
            rows: 5,
            maskSettings: {},
            id: "",
            label: "",
            name: "",
            allowBlank: !0,
            value: "",
            placeholder: "",
            readonly: !1,
            enabled: !0,
            length: {
                min: 0,
                max: -1
            },
            size: {
                field: "col-sm-8",
                label: "col-sm-4"
            },
            info: {
                prepend: "",
                append: ""
            }
        }, t), e = s.settings, s.id = e.id || IT.Utils.id(), "" == e.label && (e.size.field = "col-sm-12"), 
        e.type) {
          case "textarea":
            s.input = $(`<textarea style='resize: none;' id="${s.id}-item" ` + `class='it-edit-input' ` + `${0 == e.allowBlank ? `required` : ""} ` + `cols='${e.cols}' ` + `rows='${e.rows}' ` + `${e.readonly ? ` readonly ` : ""} ` + `${0 == e.enabled ? ` disabled ` : ""} ` + `name='${s.settings.name || IT.Utils.id()}' ` + `${e.length.min > 0 ? `minlength='${e.length.min}'` : ""} ` + `${e.length.max > 0 ? `maxlength='${e.length.max}'` : ""} ` + `>${e.value ? `${e.value}` : ""}</textarea>`);
            break;

          case "text":
          case "mask":
            s.input = $(`<input id="${s.id}-item" ` + `type='text' ` + `class='it-edit-input' ` + `name='${s.settings.name || IT.Utils.id()}' ` + `${e.length.min > 0 ? `minlength='${e.length.min}'` : ""} ` + `${e.length.max > 0 ? `maxlength='${e.length.max}'` : ""} ` + `${0 == e.allowBlank ? `required` : ""} ` + `${e.readonly ? ` readonly ` : ""} ` + `${0 == e.enabled ? ` disabled ` : ""} ` + `${e.placeholder ? `placeholder='${e.placeholder}'` : ""} ` + `${e.value ? `value='${e.value}'` : ""} ` + `>`), 
            "mask" == e.type && s.input.inputmask(e.maskSettings || {});
            break;

          default:
            console.error("input type unknown : " + e.type);
        }
        s.input.on("focus change blur", function(t) {
            s.setInvalid(!s.validate());
        });
        let n = $("<div class='it-edit' />").append(s.input);
        e.info.prepend && n.prepend($("<div />", {
            class: "it-edit-item",
            html: e.info.prepend
        })), e.info.append && n.append($("<div />", {
            class: "it-edit-item",
            html: e.info.append
        })), s.content = $((e.label ? `<div class="${e.size.label}">` + `<label for="${s.id}-item" class='it-input-label it-input-label-${e.labelAlign || "left"}'>${e.label}</label>` + `</div>` : "") + `<div class="${e.size.field}"></div>`), 
        s.content.last().append(n);
    }
}, IT.Utils = class extends IT.BaseClass {
    constructor(t) {
        super(t);
    }
    static createObject(t) {
        let e = t.xtype || t.x, s = {
            button: "Button",
            toolbar: "Toolbar",
            html: "HTML",
            flex: "Flex",
            panel: "Panel",
            form: "Form",
            textbox: "TextBox",
            checkbox: "CheckBox",
            select: "Select",
            grid: "Grid",
            datatable: "DataTable",
            tabs: "Tabs"
        };
        if (!IT[s[e]]) throw "Class IT." + s[e] + " not found";
        return s[e] && IT[s[e]] ? new IT[s[e]](t) : null;
    }
    static template(t, ...e) {
        return function(...s) {
            var n = s[s.length - 1] || {}, i = [ t[0] ];
            return e.forEach(function(e, a) {
                var o = Number.isInteger(e) ? s[e] : n[e];
                i.push(o, t[a + 1]);
            }), i.join("");
        };
    }
    static id() {
        for (var t = "IT-", e = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", s = 0; s < 5; s++) t += e.charAt(Math.floor(Math.random() * e.length));
        return t;
    }
    static isMoney(t) {
        var e = t.replace(/[$,]/g, "").replace(/\./g, "").replace(/,/g, ".").replace(/\%/g, "");
        return !isNaN(e);
    }
    static isDate(t) {
        var e = new Date(t);
        return !isNaN(e);
    }
};